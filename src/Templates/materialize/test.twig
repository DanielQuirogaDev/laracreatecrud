@extends('[[custom_master]]')

@section('content')
<div class="form-panel">

    <h3>List of {{ ucfirst('[[model_plural]]') }}</h3>

    @if(!$[[model_plural]]->isEmpty())
    <table class="table highlight" id="tbl-datatable">
        <thead>
        <tr>
            [% for column in columns %]
            <th>[[column.display]]</th>
            [% endfor %]
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        @foreach($[[model_plural]] as $[[model_singular]])
        <tr>
            [% for column in columns %]
            <td>{{ $[[model_singular]]->[[column.name]] }}</td>
            [% endfor %]
            <td>
                <a href="{{route('[[route_path]].destroy', [$[[model_singular]]->id])}}"
                   title="Delete" class="btn btn-flat btn-small right "
                   onclick="return doDelete({!! $[[model_singular]]->id !!})"><i class="material-icons">delete</i></a>
                <a href="{{route('[[route_path]].edit', [$[[model_singular]]->id])}}"
                   title="Edit" class="btn btn-flat btn-small raised right"><i class="material-icons">mode_edit</i></a>
                <a href="{{route('[[route_path]].show', [$[[model_singular]]->id])}}" title="View"
                   class="btn btn-flat btn-small right raised"><i class="material-icons">visibility</i></a>
            </td>
        </tr>
        @endforeach
        </tbody>
    </table>
    {!! $[[model_plural]]->render() !!}
    <!--<ul class="pagination">
        <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
        <li class="active"><a href="#!">1</a></li>
        <li class="waves-effect"><a href="#!">2</a></li>
        <li class="waves-effect"><a href="#!">3</a></li>
        <li class="waves-effect"><a href="#!">4</a></li>
        <li class="waves-effect"><a href="#!">5</a></li>
        <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a></li>
    </ul>
    <!-- have pagination work inside the form-panel -->
    <div class="clearfix"></div>
</div>
@else
<h3 class="center-align"> No {{ ucfirst('[[model_plural]]') }} found.</h3>
@endif
<div class="fixed-action-btn">
    <a class="btn-floating btn-large amber" title="Add {{ ucfirst('[[model_uc]]') }}"
       href="{{ url('[[route_path]]/create') }}">
        <i class="large material-icons">add</i>
    </a>

</div>

@endsection

<!-- <div class="form-group {{ $errors->has('[[i.name]]') ? 'has-error' : ''}}"> -->


[[foreach:columns]]
<div class="row">
    <div class="input-field col s12">
        [[if:i.type=='id']]
        {!! Form::text('[[i.name]]', null, ['id' => '[[i.name]]', 'readonly' => 'readonly']) !!}
        [[endif]]
        [[if:i.type=='text']]
        {!! Form::text('[[i.name]]', null, ['id' => '[[i.name]]' ]) !!}
        [[endif]]
        [[if:i.type=='number']]
        {!! Form::number('[[i.name]]', null, ['id' => '[[i.name]]' ]) !!}
        [[endif]]
        [[if:i.type=='related']]
        {!! Form::label('[[i.name]]', '[[i.display]]:' ,['class'=>'active']) !!}
        {!! Form::select('[[i.name]]', $[[model_singular]]->[[i.relatedName]]List ) !!}
        @section('scripts')

        @parent
        <script type="text/javascript">
          $(document).ready(function () {
            $('#[[i.name]]').material_select();
            //TODO Add select to the correct one
          });
        </script>
        @endsection
        [[endif]]
        [[if:i.type=='date']]
        {!! Form::date('[[i.name]]', null, ['id' => '[[i.name]]', 'class'=>'datepicker' ]) !!}
        [[endif]]

        [[if:i.type=='datetime']]
        {!! Form::date('[[i.name]]', null, ['id' => '[[i.name]]' ]) !!}
        [[endif]]

        [[if:i.type=='textarea']]
        {!! Form::textarea('[[i.name]]', null, ['id' => '[[i.name]]', 'class' => 'materialize-textarea' ]) !!}
        [[endif]]
        [[if:i.type=='unknown']]
        {!! Form::text('[[i.name]]', null, ['id' => '[[i.name]]' ]) !!}
        [[endif]]

        [[if:i.type!='related']]
        {!! Form::label('[[i.name]]', '[[i.display]]:') !!}
        [[endif]]


        @if($errors->has('[[i.name]]'))
        {!! Form::label('error-[[i.name]]', $errors->first('[[i.name]]'), ['class' => 'control-label has-error']) !!}
        @endif
    </div>
</div>
[[endforeach]]
